<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Authorization - BlackSlope.NET</title>
    <meta name="description" content="Documentation for BlackSlope.NET - A .NET Reference Architecture">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.C2c9dqG-.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CIRqPOt7.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.QfrPoxYX.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Cycwnjj0.js">
    <link rel="modulepreload" href="/assets/security_authorization.md.DJZx_v86.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-08477083><!--[--><!--]--><!--[--><span tabindex="-1" data-v-561df0f5></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-561df0f5>Skip to content</a><!--]--><!----><header class="VPNav" data-v-08477083 data-v-1e79cb7b><div class="VPNavBar" data-v-1e79cb7b data-v-829ec1cc><div class="wrapper" data-v-829ec1cc><div class="container" data-v-829ec1cc><div class="title" data-v-829ec1cc><div class="VPNavBarTitle has-sidebar" data-v-829ec1cc data-v-c6af45db><a class="title" href="/" data-v-c6af45db><!--[--><!--]--><!----><span data-v-c6af45db>BlackSlope.NET Documentation</span><!--[--><!--]--></a></div></div><div class="content" data-v-829ec1cc><div class="content-body" data-v-829ec1cc><!--[--><!--]--><div class="VPNavBarSearch search" data-v-829ec1cc><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-829ec1cc data-v-675103d6><span id="main-nav-aria-label" class="visually-hidden" data-v-675103d6> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-675103d6 data-v-78089080><!--[--><span data-v-78089080>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/getting_started/introduction.html" tabindex="0" data-v-675103d6 data-v-78089080><!--[--><span data-v-78089080>Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/architecture/overview.html" tabindex="0" data-v-675103d6 data-v-78089080><!--[--><span data-v-78089080>Architecture</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/api_reference/health_api.html" tabindex="0" data-v-675103d6 data-v-78089080><!--[--><span data-v-78089080>API Reference</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-829ec1cc data-v-94105794><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-94105794 data-v-923d509b data-v-6a33eae6><span class="check" data-v-6a33eae6><span class="icon" data-v-6a33eae6><!--[--><span class="vpi-sun sun" data-v-923d509b></span><span class="vpi-moon moon" data-v-923d509b></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-829ec1cc data-v-4e81c3af data-v-8b7536da><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-8b7536da><span class="vpi-more-horizontal icon" data-v-8b7536da></span></button><div class="menu" data-v-8b7536da><div class="VPMenu" data-v-8b7536da data-v-abcd843a><!----><!--[--><!--[--><!----><div class="group" data-v-4e81c3af><div class="item appearance" data-v-4e81c3af><p class="label" data-v-4e81c3af>Appearance</p><div class="appearance-action" data-v-4e81c3af><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-4e81c3af data-v-923d509b data-v-6a33eae6><span class="check" data-v-6a33eae6><span class="icon" data-v-6a33eae6><!--[--><span class="vpi-sun sun" data-v-923d509b></span><span class="vpi-moon moon" data-v-923d509b></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-829ec1cc data-v-19384ef9><span class="container" data-v-19384ef9><span class="top" data-v-19384ef9></span><span class="middle" data-v-19384ef9></span><span class="bottom" data-v-19384ef9></span></span></button></div></div></div></div><div class="divider" data-v-829ec1cc><div class="divider-line" data-v-829ec1cc></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-08477083 data-v-46e39d9a><div class="container" data-v-46e39d9a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-46e39d9a><span class="vpi-align-left menu-icon" data-v-46e39d9a></span><span class="menu-text" data-v-46e39d9a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-46e39d9a data-v-4d97def9><button data-v-4d97def9>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-08477083 data-v-849b6984><div class="curtain" data-v-849b6984></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-849b6984><span class="visually-hidden" id="sidebar-aria-label" data-v-849b6984> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Getting Started</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/getting_started/introduction.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Introduction</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/getting_started/prerequisites.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Prerequisites</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/getting_started/installation.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/getting_started/quick_start.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Quick Start</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Architecture</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/architecture/overview.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/architecture/project_structure.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Project Structure</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/architecture/layers.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Layers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/architecture/dependency_injection.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Dependency Injection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/architecture/middleware_pipeline.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Middleware Pipeline</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Features</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/controllers.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Controllers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/services.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Services</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/repositories.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Repositories</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/automapper.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>AutoMapper</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/validation.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Validation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/exception_handling.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Exception Handling</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/health_checks.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Health Checks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/swagger_integration.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Swagger Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/versioning.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Versioning</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/correlation_id.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Correlation ID</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/resilience.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Resilience (Polly)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/features/http_client.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>HTTP Client</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Database</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/database/entity_framework.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Entity Framework</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/database/migrations.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Migrations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/database/repository_configuration.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Repository Configuration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/database/seeding_data.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Seeding Data</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Configuration</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/configuration/application_settings.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Application Settings</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/configuration/service_configuration.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Service Configuration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/configuration/logging.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Logging</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0 has-active" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Security</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/security/authentication.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Authentication</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/security/authorization.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Authorization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/security/cors.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>CORS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/security/best_practices.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Best Practices</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>API Reference</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/api_reference/movies_api.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Movies API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/api_reference/health_api.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Health API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/api_reference/version_api.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Version API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/api_reference/error_responses.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Error Responses</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Testing</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/testing/overview.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/testing/unit_tests.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Unit Tests</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/testing/integration_tests.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Integration Tests</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/testing/bdd_tests.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>BDD Tests</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/testing/test_utilities.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Test Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Development</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/development/environment.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Environment Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/development/build_scripts.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Build Scripts</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/development/code_quality.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Code Quality</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/development/utilities.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Utilities</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/development/contributing.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Contributing</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Deployment</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/deployment/docker.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Docker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/deployment/kubernetes.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Kubernetes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/deployment/monitoring.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Monitoring</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/deployment/versioning_strategy.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Versioning Strategy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/deployment/production_best_practices.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Production Best Practices</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-79a6a4dd><section class="VPSidebarItem level-0" data-v-79a6a4dd data-v-7743fcc0><div class="item" role="button" tabindex="0" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><h2 class="text" data-v-7743fcc0>Troubleshooting</h2><!----></div><div class="items" data-v-7743fcc0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/troubleshooting/common_issues.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Common Issues</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/troubleshooting/debugging.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>Debugging</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7743fcc0 data-v-7743fcc0><div class="item" data-v-7743fcc0><div class="indicator" data-v-7743fcc0></div><a class="VPLink link link" href="/troubleshooting/faq.html" data-v-7743fcc0><!--[--><p class="text" data-v-7743fcc0>FAQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-08477083 data-v-f34ea512><div class="VPDoc has-sidebar has-aside" data-v-f34ea512 data-v-2e62732c><!--[--><!--]--><div class="container" data-v-2e62732c><div class="aside" data-v-2e62732c><div class="aside-curtain" data-v-2e62732c></div><div class="aside-container" data-v-2e62732c><div class="aside-content" data-v-2e62732c><div class="VPDocAside" data-v-2e62732c data-v-cdbf007b><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cdbf007b data-v-4d4d3658><div class="content" data-v-4d4d3658><div class="outline-marker" data-v-4d4d3658></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-4d4d3658>Contents</div><ul class="VPDocOutlineItem root" data-v-4d4d3658 data-v-ca19feda><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cdbf007b></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-2e62732c><div class="content-container" data-v-2e62732c><!--[--><!--]--><main class="main" data-v-2e62732c><div style="position:relative;" class="vp-doc _security_authorization external-link-icon-enabled" data-v-2e62732c><div><h1 id="authorization" tabindex="-1">Authorization <a class="header-anchor" href="#authorization" aria-label="Permalink to &quot;Authorization&quot;">​</a></h1><h2 id="authorization-overview" tabindex="-1">Authorization Overview <a class="header-anchor" href="#authorization-overview" aria-label="Permalink to &quot;Authorization Overview&quot;">​</a></h2><p>BlackSlope.Api implements a comprehensive authorization framework built on ASP.NET Core&#39;s authentication and authorization middleware. The application is designed to support multiple authorization strategies to provide flexible and granular access control across API endpoints.</p><h3 id="role-based-authorization" tabindex="-1">Role-Based Authorization <a class="header-anchor" href="#role-based-authorization" aria-label="Permalink to &quot;Role-Based Authorization&quot;">​</a></h3><p>Role-based authorization (RBAC) allows access control based on user roles assigned within Azure Active Directory. This approach is suitable for scenarios where permissions are grouped by organizational roles (e.g., Administrator, User, Manager).</p><p><strong>Key Characteristics:</strong></p><ul><li>Users are assigned one or more roles in Azure AD</li><li>Roles are included in the JWT token as claims</li><li>Controllers or actions can require specific roles for access</li><li>Simple to implement and understand for straightforward permission models</li></ul><h3 id="policy-based-authorization" tabindex="-1">Policy-Based Authorization <a class="header-anchor" href="#policy-based-authorization" aria-label="Permalink to &quot;Policy-Based Authorization&quot;">​</a></h3><p>Policy-based authorization provides a more flexible and powerful approach than role-based authorization. Policies are defined in code and can evaluate multiple requirements, including roles, claims, and custom logic.</p><p><strong>Key Characteristics:</strong></p><ul><li>Policies are registered in the dependency injection container during startup</li><li>Multiple requirements can be combined within a single policy</li><li>Custom authorization handlers can implement complex business logic</li><li>Policies can be reused across multiple controllers and actions</li><li>Supports both synchronous and asynchronous evaluation</li></ul><h3 id="claims-based-authorization" tabindex="-1">Claims-Based Authorization <a class="header-anchor" href="#claims-based-authorization" aria-label="Permalink to &quot;Claims-Based Authorization&quot;">​</a></h3><p>Claims-based authorization makes access decisions based on specific claims present in the user&#39;s identity token. Claims represent facts about the user (e.g., email, department, subscription level) and are issued by the identity provider (Azure AD).</p><p><strong>Key Characteristics:</strong></p><ul><li>Fine-grained access control based on user attributes</li><li>Claims are included in JWT tokens issued by Azure AD</li><li>Can be combined with policies for complex authorization scenarios</li><li>Supports custom claim types specific to your application domain</li></ul><h2 id="controller-authorization" tabindex="-1">Controller Authorization <a class="header-anchor" href="#controller-authorization" aria-label="Permalink to &quot;Controller Authorization&quot;">​</a></h2><h3 id="authorize-attribute" tabindex="-1">[Authorize] Attribute <a class="header-anchor" href="#authorize-attribute" aria-label="Permalink to &quot;[Authorize] Attribute&quot;">​</a></h3><p>The <code>[Authorize]</code> attribute is the primary mechanism for protecting API endpoints in BlackSlope.Api. This attribute can be applied at both the controller and action levels to enforce authentication and authorization requirements.</p><p><strong>Current Implementation Status:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// TODO: enable this once authentication middleware has been configured</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// [Authorize]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MoviesController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseController</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Controller implementation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>As shown in the <code>MoviesController.cs</code>, authorization is currently <strong>disabled</strong> throughout the application. The <code>[Authorize]</code> attribute is commented out pending proper authentication middleware configuration.</p><h3 id="role-requirements" tabindex="-1">Role Requirements <a class="header-anchor" href="#role-requirements" aria-label="Permalink to &quot;Role Requirements&quot;">​</a></h3><p>Role-based authorization can be implemented by specifying required roles in the <code>[Authorize]</code> attribute:</p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Require a single role</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Administrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AdminController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseController</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Only users with the Administrator role can access these endpoints</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Require multiple roles (user must have ALL specified roles)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Administrator,Manager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SensitiveOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Implementation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Require any of multiple roles (user must have AT LEAST ONE role)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Administrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Manager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModerateOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Implementation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><strong>Implementation Considerations:</strong></p><ul><li>Roles must be configured in Azure AD and included in the JWT token</li><li>Role claims are typically included as <code>http://schemas.microsoft.com/ws/2008/06/identity/claims/role</code></li><li>Multiple <code>[Authorize]</code> attributes with different roles create an OR condition</li><li>Comma-separated roles within a single attribute create an AND condition</li></ul><h3 id="policy-requirements" tabindex="-1">Policy Requirements <a class="header-anchor" href="#policy-requirements" aria-label="Permalink to &quot;Policy Requirements&quot;">​</a></h3><p>Policy-based authorization provides more flexibility than simple role checks. Policies are defined during application startup and referenced by name in the <code>[Authorize]</code> attribute.</p><p><strong>Example Policy Configuration (to be added to Startup.cs):</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Existing service configuration...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    services.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddAuthorization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Simple policy requiring a specific claim</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;RequireEmployeeId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireClaim</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;employee_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Policy requiring specific role</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;RequireAdministrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Administrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Policy with multiple requirements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;RequireManagerInFinance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Manager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireClaim</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;department&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Finance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Policy with custom requirement</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;RequireActiveSubscription&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.Requirements.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionRequirement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Register custom authorization handlers</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    services.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddSingleton</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAuthorizationHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActiveSubscriptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><strong>Using Policies in Controllers:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;RequireEmployeeId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmployeeController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseController</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // All actions require the employee_id claim</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;RequireManagerInFinance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ApproveExpense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Only Finance managers can access this endpoint</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>Custom Policy Handler Example:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionRequirement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAuthorizationRequirement</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Marker class for the requirement</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AuthorizationHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActiveSubscriptionRequirement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> readonly</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ISubscriptionService</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _subscriptionService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ISubscriptionService</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> subscriptionService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _subscriptionService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> subscriptionService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HandleRequirementAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        AuthorizationHandlerContext</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        ActiveSubscriptionRequirement</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> requirement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.User.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FindFirst</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ClaimTypes.NameIdentifier)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.Value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (userId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hasActiveSubscription</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _subscriptionService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsSubscriptionActive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userId);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (hasActiveSubscription)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            context.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Succeed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(requirement);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="current-implementation" tabindex="-1">Current Implementation <a class="header-anchor" href="#current-implementation" aria-label="Permalink to &quot;Current Implementation&quot;">​</a></h2><h3 id="authentication-currently-disabled" tabindex="-1">Authentication Currently Disabled <a class="header-anchor" href="#authentication-currently-disabled" aria-label="Permalink to &quot;Authentication Currently Disabled&quot;">​</a></h3><p><strong>Critical Security Notice:</strong> The BlackSlope.Api application currently has authentication and authorization <strong>disabled</strong> in production code. This is evident from multiple indicators in the codebase:</p><ol><li><p><strong>Commented Authorization Attributes:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// From MoviesController.cs</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// TODO: enable this once authentication middleware has been configured</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// [Authorize]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MoviesController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseController</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p><strong>Permissive CORS Configuration:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// From Startup.cs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">services.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddCors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;AllowSpecificOrigin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        builder</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> builder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AllowAnyOrigin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// TODO: Replace with FE Service Host</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AllowAnyHeader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WithMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PUT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OPTIONS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DELETE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li><li><p><strong>Authentication Middleware Configured but Not Enforced:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// From Startup.cs Configure method</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UseAuthentication</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Middleware is registered but no endpoints require it</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol><p><strong>Current State:</strong></p><ul><li>All API endpoints are publicly accessible without authentication</li><li>No authorization checks are performed on any operations</li><li>CORS allows requests from any origin</li><li>JWT token validation is configured but not enforced</li></ul><h3 id="planned-authorization-strategy" tabindex="-1">Planned Authorization Strategy <a class="header-anchor" href="#planned-authorization-strategy" aria-label="Permalink to &quot;Planned Authorization Strategy&quot;">​</a></h3><p>Based on the technology stack and existing configuration, the planned authorization strategy includes:</p><ol><li><p><strong>Azure AD Integration:</strong></p><ul><li>The application includes <code>Azure.Identity</code> (1.14.2) for modern Azure AD authentication</li><li><code>Microsoft.IdentityModel.Clients.ActiveDirectory</code> (5.2.9) for legacy scenarios</li><li>JWT token handling via <code>System.IdentityModel.Tokens.Jwt</code> (7.7.1)</li></ul></li><li><p><strong>Configuration Structure:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// From AzureAdConfig.cs</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AzureAdConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AadInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Tenant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Audience</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li><p><strong>Service Registration:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// From Startup.cs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">services.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddAzureAd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HostConfig.AzureAd);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol><p><strong>Implementation Roadmap:</strong></p><ol><li>Configure Azure AD application registration</li><li>Update <code>appsettings.json</code> with Azure AD tenant and client information</li><li>Implement JWT bearer token validation</li><li>Uncomment <code>[Authorize]</code> attributes on controllers</li><li>Define authorization policies based on application requirements</li><li>Restrict CORS to specific frontend origins</li><li>Implement role and claim mappings from Azure AD</li><li>Add authorization unit and integration tests</li></ol><h3 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h3><p><strong>Immediate Risks:</strong></p><ul><li><strong>Data Exposure:</strong> All endpoints are currently accessible without authentication, exposing potentially sensitive data</li><li><strong>Unauthorized Modifications:</strong> Create, Update, and Delete operations can be performed by anyone</li><li><strong>No Audit Trail:</strong> Without authentication, user actions cannot be tracked or audited</li><li><strong>CORS Vulnerability:</strong> <code>AllowAnyOrigin()</code> permits requests from any domain, enabling potential CSRF attacks</li></ul><p><strong>Pre-Production Checklist:</strong></p><ul><li>[ ] Enable authentication middleware enforcement</li><li>[ ] Uncomment and configure <code>[Authorize]</code> attributes on all controllers</li><li>[ ] Configure Azure AD application registration</li><li>[ ] Update CORS policy to whitelist specific frontend origins</li><li>[ ] Implement proper error handling for 401 (Unauthorized) and 403 (Forbidden) responses</li><li>[ ] Add authorization logging and monitoring</li><li>[ ] Conduct security testing and penetration testing</li><li>[ ] Review and document authorization policies</li><li>[ ] Implement rate limiting to prevent abuse</li><li>[ ] Configure HTTPS enforcement (already present via <code>app.UseHttpsRedirection()</code>)</li></ul><p><strong>Defense in Depth:</strong> Even with authorization enabled, implement additional security layers:</p><ul><li>Input validation (already implemented via FluentValidation)</li><li>SQL injection protection (provided by Entity Framework Core parameterized queries)</li><li>Exception handling middleware (already implemented)</li><li>Health checks for monitoring (already configured)</li><li>Correlation IDs for request tracking (already implemented)</li></ul><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><h3 id="principle-of-least-privilege" tabindex="-1">Principle of Least Privilege <a class="header-anchor" href="#principle-of-least-privilege" aria-label="Permalink to &quot;Principle of Least Privilege&quot;">​</a></h3><p>The principle of least privilege dictates that users should have only the minimum permissions necessary to perform their job functions. This minimizes the potential damage from compromised accounts or insider threats.</p><p><strong>Implementation Guidelines:</strong></p><ol><li><p><strong>Default Deny:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Apply [Authorize] at the controller level by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SecureController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseController</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // All actions require authentication by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Explicitly allow anonymous access only where necessary</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AllowAnonymous</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PublicEndpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Implementation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li><li><p><strong>Granular Permissions:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CanReadMovies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api/v1/movies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActionResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MovieViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Read-only operation requires read permission</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CanModifyMovies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpPost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api/v1/movies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActionResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MovieViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FromBody</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CreateMovieViewModel</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Write operation requires modify permission</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CanDeleteMovies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpDelete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api/v1/movies/{id}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActionResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DeletedMovieResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Delete operation requires explicit delete permission</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li><li><p><strong>Resource-Based Authorization:</strong> For scenarios where authorization depends on the specific resource being accessed:</p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HttpPut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api/v1/movies/{id}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActionResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MovieViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Put</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">? </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FromBody</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MovieViewModel</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> movie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _movieService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetMovieAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id.Value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Check if user has permission to modify this specific movie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> authorizationResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _authorizationService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AuthorizeAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        User, movie, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CanModifyMovie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">authorizationResult.Succeeded)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Forbid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Proceed with update</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updatedMovie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _movieService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UpdateMovieAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(movie);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HandleSuccessResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_mapper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MovieViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(updatedMovie));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ol><h3 id="authorization-policies" tabindex="-1">Authorization Policies <a class="header-anchor" href="#authorization-policies" aria-label="Permalink to &quot;Authorization Policies&quot;">​</a></h3><p><strong>Policy Design Principles:</strong></p><ol><li><p><strong>Descriptive Naming:</strong> Use clear, intention-revealing names for policies:</p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Good</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CanApproveExpenses&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Avoid</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Policy1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p><strong>Composable Policies:</strong> Build complex policies from simpler requirements:</p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">services.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddAuthorization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Base policies</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;IsEmployee&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireClaim</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;employee_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;IsManager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Manager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Composed policy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CanApproveExpenses&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Manager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireClaim</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;department&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        policy.Requirements.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BudgetAuthorityRequirement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li><li><p><strong>Centralized Policy Configuration:</strong> Create a dedicated configuration class for authorization policies:</p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AuthorizationPolicies</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CanReadMovies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CanReadMovies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CanModifyMovies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CanModifyMovies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CanDeleteMovies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CanDeleteMovies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RequireAdministrator</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;RequireAdministrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConfigurePolicies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AuthorizationOptions</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CanReadMovies, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireAuthenticatedUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CanModifyMovies, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Editor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Administrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CanDeleteMovies, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Administrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(RequireAdministrator, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RequireRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Administrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// In Startup.cs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">services.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddAuthorization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AuthorizationPolicies.ConfigurePolicies);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div></li></ol><h3 id="testing-authorization" tabindex="-1">Testing Authorization <a class="header-anchor" href="#testing-authorization" aria-label="Permalink to &quot;Testing Authorization&quot;">​</a></h3><p><strong>Unit Testing Authorization Logic:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MovieControllerAuthorizationTests</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Get_WithoutAuthentication_ReturnsUnauthorized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Arrange</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateControllerWithoutAuthentication</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Act</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controller.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Assert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsInstanceOfType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result.Result, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UnauthorizedResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Delete_WithoutAdminRole_ReturnsForbidden</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Arrange</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateControllerWithUserRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Act</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controller.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Assert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsInstanceOfType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result.Result, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ForbidResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Delete_WithAdminRole_ReturnsNoContent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Arrange</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateControllerWithAdminRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Act</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controller.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Assert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsInstanceOfType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result.Result, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NoContentResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><strong>Integration Testing with Authentication:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MovieControllerIntegrationTests</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HttpClient</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _validToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestInitialize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateTestClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _validToken </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetTestJwtToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetMovies_WithValidToken_ReturnsSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Arrange</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _client.DefaultRequestHeaders.Authorization </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AuthenticationHeaderValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Bearer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, _validToken);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Act</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _client.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/v1/movies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Assert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AreEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpStatusCode.OK, response.StatusCode);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetMovies_WithoutToken_ReturnsUnauthorized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Act</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _client.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/v1/movies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Assert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AreEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HttpStatusCode.Unauthorized, response.StatusCode);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p><strong>Testing Custom Authorization Handlers:</strong></p><div class="language-csharp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionHandlerTests</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TestMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HandleRequirement_WithActiveSubscription_Succeeds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Arrange</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mockSubscriptionService</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Mock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ISubscriptionService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mockSubscriptionService</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> s.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsSubscriptionActive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(It.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsAny</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;()))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ReturnsAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mockSubscriptionService.Object);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> requirement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ActiveSubscriptionRequirement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateUserWithClaims</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AuthorizationHandlerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] { requirement }, user, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Act</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> handler.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HandleAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Assert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsTrue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context.HasSucceeded);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>Authorization Testing Checklist:</strong></p><ul><li>[ ] Test unauthenticated access returns 401</li><li>[ ] Test authenticated but unauthorized access returns 403</li><li>[ ] Test each role has appropriate access</li><li>[ ] Test policy requirements are enforced</li><li>[ ] Test custom authorization handlers</li><li>[ ] Test resource-based authorization</li><li>[ ] Test authorization with expired tokens</li><li>[ ] Test authorization with invalid tokens</li><li>[ ] Test authorization with missing claims</li><li>[ ] Test authorization edge cases and boundary conditions</li></ul><h2 id="related-documentation" tabindex="-1">Related Documentation <a class="header-anchor" href="#related-documentation" aria-label="Permalink to &quot;Related Documentation&quot;">​</a></h2><p>For additional information on related security and implementation topics, refer to:</p><ul><li><a href="/security/authentication.html">Authentication</a> - Detailed authentication configuration and JWT token handling</li><li><a href="/features/controllers.html">Controllers</a> - Controller implementation patterns and best practices</li><li><a href="/deployment/production_best_practices.html">Production Best Practices</a> - Security hardening and deployment guidelines</li></ul><h2 id="migration-path" tabindex="-1">Migration Path <a class="header-anchor" href="#migration-path" aria-label="Permalink to &quot;Migration Path&quot;">​</a></h2><p>To enable authorization in the BlackSlope.Api application, follow this migration path:</p><ol><li><strong>Configure Azure AD</strong> (see <a href="/security/authentication.html">Authentication</a>)</li><li><strong>Define Authorization Policies</strong> in <code>Startup.cs</code></li><li><strong>Uncomment <code>[Authorize]</code> Attributes</strong> on controllers</li><li><strong>Add Policy-Specific Attributes</strong> where needed</li><li><strong>Update CORS Configuration</strong> to restrict origins</li><li><strong>Test Authorization</strong> using the testing strategies above</li><li><strong>Monitor and Audit</strong> authorization decisions in production</li></ol></div></div></main><footer class="VPDocFooter" data-v-2e62732c data-v-6db614b6><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-6db614b6><span class="visually-hidden" id="doc-footer-aria-label" data-v-6db614b6>Pager</span><div class="pager" data-v-6db614b6><a class="VPLink link pager-link prev" href="/security/authentication.html" data-v-6db614b6><!--[--><span class="desc" data-v-6db614b6>Previous page</span><span class="title" data-v-6db614b6>Authentication</span><!--]--></a></div><div class="pager" data-v-6db614b6><a class="VPLink link pager-link next" href="/security/cors.html" data-v-6db614b6><!--[--><span class="desc" data-v-6db614b6>Next page</span><span class="title" data-v-6db614b6>CORS</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-08477083 data-v-3d8f0d8a><div class="container" data-v-3d8f0d8a><!----><p class="copyright" data-v-3d8f0d8a>© Slalom, Inc. All rights reserved. Auto-generated by GenAI via TaskStream. Always verify for accuracy.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_reference_error_responses.md\":\"843tro5z\",\"api_reference_health_api.md\":\"C3awUm82\",\"api_reference_movies_api.md\":\"DG2K85Q5\",\"api_reference_version_api.md\":\"CgqWeSmp\",\"architecture_dependency_injection.md\":\"DlMJNq_K\",\"architecture_layers.md\":\"DPrsBoZk\",\"architecture_middleware_pipeline.md\":\"y6XD6OCp\",\"architecture_overview.md\":\"B1gsAp_v\",\"architecture_project_structure.md\":\"0lgK2T8L\",\"configuration_application_settings.md\":\"C-pr1iqk\",\"configuration_logging.md\":\"DjuGhHjq\",\"configuration_service_configuration.md\":\"CH850BxE\",\"database_entity_framework.md\":\"D5aKwhys\",\"database_migrations.md\":\"DbSJf2xQ\",\"database_repository_configuration.md\":\"BoQLUIdw\",\"database_seeding_data.md\":\"Ckn7WcYS\",\"deployment_docker.md\":\"ZrVcYN9f\",\"deployment_kubernetes.md\":\"CvdpTl5B\",\"deployment_monitoring.md\":\"BAuinbxR\",\"deployment_production_best_practices.md\":\"BAZCGOPq\",\"deployment_versioning_strategy.md\":\"DJv6WMwt\",\"development_build_scripts.md\":\"C72SgFnJ\",\"development_code_quality.md\":\"CC7gxywF\",\"development_contributing.md\":\"Beg1vDiC\",\"development_environment.md\":\"BK2zZm1p\",\"development_utilities.md\":\"D6ixHDsw\",\"features_automapper.md\":\"CLCnXnpd\",\"features_controllers.md\":\"DYHOFksW\",\"features_correlation_id.md\":\"DWrxzZ5U\",\"features_exception_handling.md\":\"hpuN8Wru\",\"features_health_checks.md\":\"CcylugK3\",\"features_http_client.md\":\"B7Vq8mjh\",\"features_repositories.md\":\"DnK0o2W8\",\"features_resilience.md\":\"DkWVoTdz\",\"features_services.md\":\"CQ3W7wbk\",\"features_swagger_integration.md\":\"DT3fT0cv\",\"features_validation.md\":\"BUPRAoTL\",\"features_versioning.md\":\"DZ_TTBY2\",\"getting_started_installation.md\":\"DLlWNBIk\",\"getting_started_introduction.md\":\"DlCGfMpJ\",\"getting_started_prerequisites.md\":\"CoKU8q2w\",\"getting_started_quick_start.md\":\"CM3DTCbd\",\"index.md\":\"C4kPoYsN\",\"security_authentication.md\":\"5vH38omZ\",\"security_authorization.md\":\"DJZx_v86\",\"security_best_practices.md\":\"zXkczA1u\",\"security_cors.md\":\"k-xntvrj\",\"testing_bdd_tests.md\":\"DiKGffhq\",\"testing_integration_tests.md\":\"DkR4kXtW\",\"testing_overview.md\":\"BEFCfo0s\",\"testing_test_utilities.md\":\"DPgXn6x6\",\"testing_unit_tests.md\":\"BbMUWHu6\",\"troubleshooting_common_issues.md\":\"DIzUiadW\",\"troubleshooting_debugging.md\":\"B6ovc0FH\",\"troubleshooting_faq.md\":\"B52OP08j\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"BlackSlope.NET Documentation\",\"titleTemplate\":\":title - BlackSlope.NET\",\"description\":\"Documentation for BlackSlope.NET - A .NET Reference Architecture\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"link\":\"/getting_started/introduction\"},{\"text\":\"Architecture\",\"link\":\"/architecture/overview\"},{\"text\":\"API Reference\",\"link\":\"/api_reference/health_api\"}],\"sidebar\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Introduction\",\"link\":\"/getting_started/introduction\"},{\"text\":\"Prerequisites\",\"link\":\"/getting_started/prerequisites\"},{\"text\":\"Installation\",\"link\":\"/getting_started/installation\"},{\"text\":\"Quick Start\",\"link\":\"/getting_started/quick_start\"}]},{\"text\":\"Architecture\",\"items\":[{\"text\":\"Overview\",\"link\":\"/architecture/overview\"},{\"text\":\"Project Structure\",\"link\":\"/architecture/project_structure\"},{\"text\":\"Layers\",\"link\":\"/architecture/layers\"},{\"text\":\"Dependency Injection\",\"link\":\"/architecture/dependency_injection\"},{\"text\":\"Middleware Pipeline\",\"link\":\"/architecture/middleware_pipeline\"}]},{\"text\":\"Features\",\"items\":[{\"text\":\"Controllers\",\"link\":\"/features/controllers\"},{\"text\":\"Services\",\"link\":\"/features/services\"},{\"text\":\"Repositories\",\"link\":\"/features/repositories\"},{\"text\":\"AutoMapper\",\"link\":\"/features/automapper\"},{\"text\":\"Validation\",\"link\":\"/features/validation\"},{\"text\":\"Exception Handling\",\"link\":\"/features/exception_handling\"},{\"text\":\"Health Checks\",\"link\":\"/features/health_checks\"},{\"text\":\"Swagger Integration\",\"link\":\"/features/swagger_integration\"},{\"text\":\"Versioning\",\"link\":\"/features/versioning\"},{\"text\":\"Correlation ID\",\"link\":\"/features/correlation_id\"},{\"text\":\"Resilience (Polly)\",\"link\":\"/features/resilience\"},{\"text\":\"HTTP Client\",\"link\":\"/features/http_client\"}]},{\"text\":\"Database\",\"items\":[{\"text\":\"Entity Framework\",\"link\":\"/database/entity_framework\"},{\"text\":\"Migrations\",\"link\":\"/database/migrations\"},{\"text\":\"Repository Configuration\",\"link\":\"/database/repository_configuration\"},{\"text\":\"Seeding Data\",\"link\":\"/database/seeding_data\"}]},{\"text\":\"Configuration\",\"items\":[{\"text\":\"Application Settings\",\"link\":\"/configuration/application_settings\"},{\"text\":\"Service Configuration\",\"link\":\"/configuration/service_configuration\"},{\"text\":\"Logging\",\"link\":\"/configuration/logging\"}]},{\"text\":\"Security\",\"items\":[{\"text\":\"Authentication\",\"link\":\"/security/authentication\"},{\"text\":\"Authorization\",\"link\":\"/security/authorization\"},{\"text\":\"CORS\",\"link\":\"/security/cors\"},{\"text\":\"Best Practices\",\"link\":\"/security/best_practices\"}]},{\"text\":\"API Reference\",\"items\":[{\"text\":\"Movies API\",\"link\":\"/api_reference/movies_api\"},{\"text\":\"Health API\",\"link\":\"/api_reference/health_api\"},{\"text\":\"Version API\",\"link\":\"/api_reference/version_api\"},{\"text\":\"Error Responses\",\"link\":\"/api_reference/error_responses\"}]},{\"text\":\"Testing\",\"items\":[{\"text\":\"Overview\",\"link\":\"/testing/overview\"},{\"text\":\"Unit Tests\",\"link\":\"/testing/unit_tests\"},{\"text\":\"Integration Tests\",\"link\":\"/testing/integration_tests\"},{\"text\":\"BDD Tests\",\"link\":\"/testing/bdd_tests\"},{\"text\":\"Test Utilities\",\"link\":\"/testing/test_utilities\"}]},{\"text\":\"Development\",\"items\":[{\"text\":\"Environment Setup\",\"link\":\"/development/environment\"},{\"text\":\"Build Scripts\",\"link\":\"/development/build_scripts\"},{\"text\":\"Code Quality\",\"link\":\"/development/code_quality\"},{\"text\":\"Utilities\",\"link\":\"/development/utilities\"},{\"text\":\"Contributing\",\"link\":\"/development/contributing\"}]},{\"text\":\"Deployment\",\"items\":[{\"text\":\"Docker\",\"link\":\"/deployment/docker\"},{\"text\":\"Kubernetes\",\"link\":\"/deployment/kubernetes\"},{\"text\":\"Monitoring\",\"link\":\"/deployment/monitoring\"},{\"text\":\"Versioning Strategy\",\"link\":\"/deployment/versioning_strategy\"},{\"text\":\"Production Best Practices\",\"link\":\"/deployment/production_best_practices\"}]},{\"text\":\"Troubleshooting\",\"items\":[{\"text\":\"Common Issues\",\"link\":\"/troubleshooting/common_issues\"},{\"text\":\"Debugging\",\"link\":\"/troubleshooting/debugging\"},{\"text\":\"FAQ\",\"link\":\"/troubleshooting/faq\"}]}],\"search\":{\"provider\":\"local\"},\"footer\":{\"message\":\"\",\"copyright\":\"© Slalom, Inc. All rights reserved. Auto-generated by GenAI via TaskStream. Always verify for accuracy.\"},\"externalLinkIcon\":true,\"outline\":{\"level\":\"deep\",\"label\":\"Contents\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>